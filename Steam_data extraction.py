import requests
import pandas as pd

def get_steam_reviews(app_id):
    url = f"https://store.steampowered.com/appreviews/{app_id}?json=1"
    response = requests.get(url)
    if response.status_code == 200:
        return response.json()
    else:
        print(f"Failed to fetch reviews for app ID {app_id}. Status code: {response.status_code}")
        return None

# List of game IDs
game_ids = [
    343050, 2962130, 1380410, 2411460, 1818750, 1622910, 2945510, 2371140, 2154420, 1613010,2592170, 2400840, 2168230, 1275530, 2213670, 1969370, 1493710, 911460, 2155180, 2009620,
    2565260, 2925330, 1435790, 867210, 2078450, 2215430, 2818260, 2904270, 2820060, 2705920,2727500, 2727510, 2700410, 1042420, 2312770, 951440, 2977330, 2242050, 1146980, 2752910,
    971700, 1619280, 322330, 1494560, 363860, 2721150, 822500, 2780970, 2139090, 2362960, 1942410, 2778530, 2928320, 2952800, 2593470, 2541780, 494730, 2479810, 2446540, 2264020,
    2909700, 2770510, 2213190, 2977280, 2953230, 1491410, 2366270, 2490990, 2808690, 2719140,2973620, 2639340, 1973310, 1748110, 2414480, 1419170, 2376580, 1522870, 1222970, 471710,
    1823220, 551370, 1371980, 2502780, 2055310, 2458570, 1742390, 1270510, 2618360, 2967310, 575720, 1769830, 2518050, 2616090, 1925090, 2313360, 1472930, 2515010, 1273990, 1989070,
    1981680, 2350240, 2053310, 1024020, 2210340, 2595940, 1847800, 1573550, 2824660, 2457550, 1931930, 2912120, 1230530, 2705130, 2332970, 2977320, 1318400, 2102040, 2615380, 2841280,
    1715590, 2816400, 2114740, 686810, 1669480, 2958130, 2561540, 2479830, 2319670, 2141280, 2823170, 1822550, 2064690, 2208570, 2707070, 2617340, 2342290, 1324780, 2783370, 1359730,
    1143910, 1507190, 2747800, 1361650, 2572400, 1868140, 1840080, 895400, 2936910, 2488620,1315180, 2551590, 1116980, 1465460, 1121640, 1904480, 2477010, 1554810, 2872270, 2866880,
    2430920, 2950370, 2175830, 2932260, 1939920, 1481170, 2532330, 1676840, 2129530, 2791430, 1420710, 2428160, 2431950, 1240630, 2337640, 813780, 2078230, 2240150, 2839420, 2347300,
    2961860, 2133760, 2798790, 2460740, 1317020, 2305130, 2534370, 2965520, 1935350, 1843310,1359510, 2430050, 2058810, 1184120, 2672170, 2167470, 2606990, 2532230, 2976910, 2928090,
    2022000, 2350790, 2313470, 2493560, 2199400, 2889380, 2802090, 2927350, 2067830, 1084800, 1231990, 1859910, 2946010, 2027510, 2919080, 1840800, 1618170, 1818140, 1809540, 2754490,
    2000890, 2840890, 1908660, 1554120, 2944260, 2283040, 1924180, 2288470, 1841150, 2520820,1316680, 1343070, 1604030, 2955530, 2885500, 1377380, 2484130, 2111460, 2076360, 2953350,
    2920720, 2138720, 1934570, 2563100, 2887520, 2919680, 2854160, 2652000, 1486450, 1575420]

# Empty list to store the reviews dataframes
reviews_dfs = []

# Iterate through each game ID, fetch reviews, and append the dataframes to the list
for app_id in game_ids:
    reviews_data = get_steam_reviews(app_id)
    if reviews_data:
        reviews_df = pd.json_normalize(reviews_data['reviews'], sep='_')
        reviews_df['game_id'] = app_id
        reviews_dfs.append(reviews_df)

# Concatenate all the dataframes into a single dataframe
data = pd.concat(reviews_dfs)

# Display the concatenated dataframe
print(data)

# Save the concatenated dataframe to Excel
data.to_excel('steam_reviews.xlsx', index=False)
